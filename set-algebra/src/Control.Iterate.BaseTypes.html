<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Defines what types can be used in the SetAlgebra, and</span><span>
</span><span id="line-9"></span><span class="hs-comment">--   what operations those types must support (Iter, Basic, Embed)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Iterate.BaseTypes</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html"><span class="hs-identifier">Control.Iterate.Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier">hasElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier">isempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier">none</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier">one</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">sortBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">Data.MapExtras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">StrictTriple</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier">splitMemberSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">--  $ClassesForSetAlgebra</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- ================= The Iter class =================================================</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | The Set algebra include types that encode finite sets and maps of some type. They</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- have a finite domain, and for each domain element they pair a single range</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- element (unit for sets). We are interested in those finite maps that can iterate their</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- pairs in ascending domain order. The operations are: `nxt` and `lub` .</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- lub can skip over many items in sub-linear time, it can make things really fast.</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Many finite maps can support a support lub operation in sub-linear time. Some examples:</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Balanced binary trees, Arrays (using binary search), Tries, etc. There are basic and compound</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Iter instances. Compound types include components with types that have Iter instances.</span><span>
</span><span id="line-32"></span><span class="hs-keyword">class</span><span> </span><span id="Iter"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-var">Iter</span></a></span></span><span> </span><span id="local-6989586621679062640"><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span id="nxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-type">nxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062632"><span id="local-6989586621679062633"><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062633"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062632"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062633"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062632"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062633"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062632"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-34"></span><span>  </span><span id="lub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-type">lub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062626"><span id="local-6989586621679062627"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062626"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062627"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062626"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062626"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">-- | The next few methods can all be defined via nxt and lub, but for base types there often exist</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- much more efficent means, so the default definitions should be overwritten for such basic types.</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- For compound types with Guards, these are often the only way to define them.</span><span>
</span><span id="line-39"></span><span>  </span><span id="hasNxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-type">hasNxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062638"><span id="local-6989586621679062639"><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062638"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062638"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062638"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679062318"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var hs-var">hasNxt</span></a></span><span> </span><span id="local-6989586621679062316"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679062316"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679062316"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span id="hasLub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-type">hasLub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062630"><span id="local-6989586621679062631"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062630"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062631"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062630"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062631"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062630"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679062314"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var hs-var">hasLub</span></a></span><span> </span><span id="local-6989586621679062310"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062310"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679062309"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679062309"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062310"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679062309"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-44"></span><span>  </span><span id="haskey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-type">haskey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062624"><span id="local-6989586621679062625"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062625"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062625"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062625"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062624"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679062307"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679062300"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062300"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062299"><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679062299"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062300"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679062299"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, b, f key b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062298"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062300"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">key</span></a></span></span><span>
</span><span id="line-46"></span><span>  </span><span id="isnull"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-type">isnull</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062618"><span id="local-6989586621679062619"><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062619"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062618"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679062296"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var">isnull</span></a></span><span> </span><span id="local-6989586621679062294"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Collect t -&gt; Bool
</span><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier hs-var">isempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-48"></span><span>  </span><span id="lookup"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062613"><span id="local-6989586621679062614"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062614"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062614"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062614"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062613"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062613"><span class="hs-identifier hs-type">rng</span></a></span></span></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679062292"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679062286"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062286"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062285"><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679062285"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062286"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679062285"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, rng, f key rng)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062284"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062284"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062283"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679062283"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key rng
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062286"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062284"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679062283"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span id="element"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-type">element</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062608"><span id="local-6989586621679062609"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062609"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062609"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062640"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062609"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062608"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679062281"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-var hs-var">element</span></a></span><span> </span><span id="local-6989586621679062277"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062277"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062276"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062276"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062277"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062276"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- ==================================================================================================</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | In order to build typed 'Exp' (which are a typed deep embedding) of map and set operations, we need to know</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- what kind of basic types can be used this way. Every Basic type has a few operations</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- for creating one from a list, for adding and removing key-value pairs, looking up a value given a key.</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Instances of this algebra are functional in that every key has exactly one value associated with it.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">class</span><span> </span><span id="Basic"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-var">Basic</span></a></span></span><span> </span><span id="local-6989586621679062603"><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">-- | in addpair the new value always prevails, to make a choice use 'addkv' which has a combining function that allows choice.</span><span>
</span><span id="line-61"></span><span>  </span><span id="addpair"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-type">addpair</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062604"><span id="local-6989586621679062605"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062605"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062605"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062605"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062604"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062605"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062604"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679062273"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-var hs-var">addpair</span></a></span><span> </span><span id="local-6989586621679062269"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062269"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062268"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062268"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679062267"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062267"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062269"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062268"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679062267"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062265"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062265"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679062264"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062264"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062264"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">-- | use (\ old new -&gt; old) if you want the v in (f k v) to prevail, and use (\ old new -&gt; new) if you want the v in (k,v) to prevail</span><span>
</span><span id="line-65"></span><span>  </span><span id="addkv"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-type">addkv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062599"><span id="local-6989586621679062600"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062599"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">-- | remove the pair with key 'k', if it is there.</span><span>
</span><span id="line-68"></span><span>  </span><span id="removekey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-type">removekey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062581"><span id="local-6989586621679062582"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062581"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062582"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062581"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- | the set of keys</span><span>
</span><span id="line-71"></span><span>  </span><span id="domain"><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-type">domain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062579"><span id="local-6989586621679062580"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062580"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062580"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062579"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679062580"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- | the set of values.</span><span>
</span><span id="line-74"></span><span>  </span><span id="range"><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-type">range</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679062577"><span id="local-6989586621679062578"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062578"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062603"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062577"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062578"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679062578"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- $Deep embedding</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | BaseRep witnesses Basic types. I.e. those types that are instances of both Basic and Iter.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--   Pattern matching against a constructor of type BaseRep, determines which base type. For example</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   data Tag f k v = Tag (BaseRep f k v) (f k v)</span><span>
</span><span id="line-83"></span><span class="hs-comment">--   case Tag MapR x -&gt;  -- here we know x :: Map.Map k v</span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="BaseRep"><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-var">BaseRep</span></a></span></span><span> </span><span id="local-6989586621679062260"><span class="annot"><a href="#local-6989586621679062260"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679062259"><span class="annot"><a href="#local-6989586621679062259"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679062258"><span class="annot"><a href="#local-6989586621679062258"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679062256"><span id="local-6989586621679062257"><span id="MapR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679062257"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062256"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679062254"><span id="SetR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062254"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679062251"><span id="local-6989586621679062252"><span id="ListR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062252"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062251"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679062248"><span id="local-6989586621679062249"><span id="SingleR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062249"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062248"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062242"><span id="local-6989586621679062245"><span id="local-6989586621679062594"><span id="local-6989586621679062595"><span id="local-6989586621679062596"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062596"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062595"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062594"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679062240"><span class="annot"><span class="annottext">show :: BaseRep f k v -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Map&quot;</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set&quot;</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List&quot;</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single&quot;</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Now for each Basic type we provide instances</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- MapAndSetTypes</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- ========== Basic List ==============</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Maps stored as lists. Sorted [(key,value)] pairs, with no duplicate keys.</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- The constructor for List is hidden, since it requires some invariants. Use 'fromPairs' to build an initial List.</span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679062229"><span class="annot"><a href="#local-6989586621679062229"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679062228"><span class="annot"><a href="#local-6989586621679062228"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679062573"><span id="local-6989586621679062574"><span id="UnSafeList"><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062574"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062574"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062573"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062574"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062573"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679062592"><span id="local-6989586621679062593"><span class="annot"><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-type">unList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062593"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062592"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062593"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062592"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-109"></span><span id="unList"><span class="annot"><span class="annottext">unList :: forall k v. List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-var hs-var">unList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062224"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062224"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062224"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679062220"><span id="local-6989586621679062222"><span id="local-6989586621679062588"><span id="local-6989586621679062589"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062589"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062588"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062589"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062588"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062214"><span id="local-6989586621679062217"><span id="local-6989586621679062586"><span id="local-6989586621679062587"><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062587"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062586"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062587"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062586"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679062213"><span class="annot"><span class="annottext">show :: List k v -&gt; String
</span><a href="#local-6989586621679062213"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062207"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062207"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062207"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062205"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679062198"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; List k v -&gt; (v -&gt; v -&gt; v) -&gt; List k v
</span><a href="#local-6989586621679062198"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062197"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062196"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062192"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062192"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062191"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062192"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>      </span><span id="local-6989586621679062190"><span class="annot"><span class="annottext">insert :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062189"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062188"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062187"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-124"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679062183"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; List k v -&gt; List k v
</span><a href="#local-6989586621679062183"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679062182"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062182"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062178"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062178"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062177"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062178"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621679062177"><span class="annot"><span class="annottext">remove :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062177"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><a href="#local-6989586621679062177"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062176"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062176"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062175"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062175"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062174"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062174"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062176"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062182"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062174"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062182"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062175"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679062177"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062174"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679062172"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; List k v -&gt; Set k
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062167"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679062165"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062165"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062164"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062164"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062163"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679062163"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062165"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679062163"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679062159"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; List k v -&gt; Set v
</span><a href="#local-6989586621679062159"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062155"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062155"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679062154"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062154"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062153"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062152"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679062152"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679062152"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062155"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679062560"><span id="local-6989586621679062561"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-type">fromPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062561"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062560"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062560"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062560"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062561"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062560"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062561"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062560"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="fromPairs"><span class="annot"><span class="annottext">fromPairs :: forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679062146"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062146"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679062145"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062145"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062146"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062143"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062143"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679062142"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062142"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062143"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062142"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062145"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679062556"><span id="local-6989586621679062557"><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062557"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062556"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062556"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062556"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062557"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062556"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062557"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062556"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-136"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679062136"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062136"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679062135"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062135"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679062134"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062134"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062133"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062133"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062134"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062133"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679062132"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062132"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062131"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062131"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062130"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062130"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062129"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062129"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062128"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062128"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062127"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062127"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062131"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062129"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062132"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062131"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062132"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062130"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062128"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062127"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679062126"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062126"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062125"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062125"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062124"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062124"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679062125"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062126"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062124"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062113"><span id="local-6989586621679062117"><span id="local-6989586621679062119"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- List is the only basic instance with non-linear nxt and lub. It also depends on</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679062111"><span class="annot"><span class="annottext">nxt :: forall a b. List a b -&gt; Collect (a, b, List a b)
</span><a href="#local-6989586621679062111"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span> </span><span class="hs-comment">-- key-value pairs being stored in ascending order. For small Lists (10 or so elements) this is OK.</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062107"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062107"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062106"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062105"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679062105"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062107"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679062105"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679062103"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; List k b -&gt; Collect (k, b, List k b)
</span><a href="#local-6989586621679062103"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679062102"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062102"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062098"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679062098"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679062096"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062096"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062095"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062095"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062096"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062102"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679062098"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062093"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062093"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062092"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062092"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062091"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679062091"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062093"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062092"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679062091"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679062090"><span class="annot"><span class="annottext">isnull :: forall k v. List k v -&gt; Bool
</span><a href="#local-6989586621679062090"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062087"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062087"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679062087"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679062083"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; List key rng -&gt; Maybe rng
</span><a href="#local-6989586621679062083"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679062082"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062082"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679062079"><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679062082"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679062077"><span class="annot"><span class="annottext">hasNxt :: forall a b. List a b -&gt; Maybe (a, b, List a b)
</span><a href="#local-6989586621679062077"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasNxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679062073"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062073"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062072"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679062071"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062073"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- ================ Basic Single ===============</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Maps and sets with zero or a single pair. Iteration is trivial. Succeeds at most once.</span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span id="local-6989586621679062070"><span class="annot"><a href="#local-6989586621679062070"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679062069"><span class="annot"><a href="#local-6989586621679062069"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679062529"><span id="local-6989586621679062530"><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679062530"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062529"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062530"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062529"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679062524"><span id="local-6989586621679062525"><span id="Fail"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062525"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679062528"><span id="SetSingle"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679062528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062528"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679062060"><span id="local-6989586621679062064"><span id="local-6989586621679062533"><span id="local-6989586621679062534"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062534"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062533"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062534"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062533"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Since we can only store one key, we have to choose who wins</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- We use the combine function to decide. (\ old new -&gt; old) keeps</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- the orginal value. (\ old new -&gt; new) overwrites the stored value.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Something else like (\ old new -&gt; old+new) overwrites with a combination</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062058"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679062052"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; Single k v -&gt; (v -&gt; v -&gt; v) -&gt; Single k v
</span><a href="#local-6989586621679062052"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062051"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062051"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062050"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062049"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679062049"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679062048"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062048"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679062049"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679062047"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062047"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679062046"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062046"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062047"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679062048"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062046"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679062044"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062044"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062044"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062051"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679062040"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Single k v -&gt; Single k v
</span><a href="#local-6989586621679062040"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679062039"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062039"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679062038"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679062037"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062037"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062039"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062037"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679062036"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679062033"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062033"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062033"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062033"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679062032"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062032"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679062030"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Single k v -&gt; Set k
</span><a href="#local-6989586621679062030"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679062029"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062029"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679062028"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062028"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062029"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679062025"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062025"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679062023"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Single k v -&gt; Set v
</span><a href="#local-6989586621679062023"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679062022"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062022"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679062021"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062021"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679062021"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679062019"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679062019"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062008"><span id="local-6989586621679062013"><span id="local-6989586621679062015"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679062007"><span class="annot"><span class="annottext">nxt :: forall a b. Single a b -&gt; Collect (a, b, Single a b)
</span><a href="#local-6989586621679062007"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679062006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062006"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062005"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062005"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062003"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679062003"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679062002"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062006"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679062005"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679062003"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679062000"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062000"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061999"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061999"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061998"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061998"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061998"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062000"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061999"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Single a b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061997"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061997"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061996"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061996"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061997"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679061994"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Single k b -&gt; Collect (k, b, Single k b)
</span><a href="#local-6989586621679061994"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679061993"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061993"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679061992"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061992"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679061991"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061991"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061989"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061989"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061988"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061988"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061992"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061993"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061988"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061992"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061991"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061989"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061989"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679061986"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061986"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679061984"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061982"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061982"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061981"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061981"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061986"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061981"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061982"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061982"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679061980"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061980"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061979"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061979"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061978"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061978"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061979"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679061974"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Single key b -&gt; Bool
</span><a href="#local-6989586621679061974"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679061973"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061973"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679061970"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061970"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061973"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061970"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679061969"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679061968"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061968"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679061967"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061967"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061968"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679061966"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061966"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679061965"><span class="annot"><span class="annottext">isnull :: forall k v. Single k v -&gt; Bool
</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679061961"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Single key rng -&gt; Maybe rng
</span><a href="#local-6989586621679061961"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679061960"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679061957"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061957"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061957"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679061956"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061956"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679061955"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061955"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679061954"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679061954"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061956"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061955"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679061954"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679061953"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061953"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key rng
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061948"><span id="local-6989586621679061951"><span id="local-6989586621679062499"><span id="local-6989586621679062500"><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062500"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062499"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062500"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062499"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679061945"><span class="annot"><span class="annottext">show :: Single k v -&gt; String
</span><a href="#local-6989586621679061945"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679061944"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061944"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679061943"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061943"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Single &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061944"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061943"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679061940"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061940"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(SetSingle &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061940"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fail&quot;</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- ================= Basic Set =====================</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span id="local-6989586621679061939"><span class="annot"><a href="#local-6989586621679061939"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679061938"><span class="annot"><a href="#local-6989586621679061938"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679062495"><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679062495"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062495"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679061929"><span class="annot"><span class="annottext">addpair :: forall k v. Ord k =&gt; k -&gt; v -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679061929"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span id="local-6989586621679061928"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061928"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679061927"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061927"><span class="hs-identifier hs-var">_unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061924"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061924"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061928"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061924"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679061922"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; Sett k v -&gt; (v -&gt; v -&gt; v) -&gt; Sett k v
</span><a href="#local-6989586621679061922"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061921"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061921"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061920"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061920"><span class="hs-identifier hs-var">_unit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061917"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061917"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061916"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679061916"><span class="hs-identifier hs-var">_comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061921"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061917"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We can ignore comb since there is only one function at type: () -&gt; () -&gt; ()</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679061914"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679061914"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679061913"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061913"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061910"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061910"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061913"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061910"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679061907"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Sett k v -&gt; Set k
</span><a href="#local-6989586621679061907"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061905"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061905"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061905"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679061903"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Sett k v -&gt; Set v
</span><a href="#local-6989586621679061903"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061901"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061901"><span class="hs-identifier hs-var">_xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061896"><span id="local-6989586621679061899"><span id="local-6989586621679062486"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062486"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062486"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679061895"><span class="annot"><span class="annottext">show :: Sett key () -&gt; String
</span><a href="#local-6989586621679061895"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061891"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679061887"><span id="local-6989586621679061889"><span id="local-6989586621679062484"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062484"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061876"><span id="local-6989586621679061881"><span id="local-6989586621679061883"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679061875"><span class="annot"><span class="annottext">nxt :: forall a b. Sett a b -&gt; Collect (a, b, Sett a b)
</span><a href="#local-6989586621679061875"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061873"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679061873"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061872"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061872"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061871"><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061871"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679061873"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061872"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061869"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061869"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061868"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679061868"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679061873"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061871"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061869"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679061868"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061872"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679061865"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Sett k b -&gt; Collect (k, b, Sett k b)
</span><a href="#local-6989586621679061865"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679061864"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061864"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061862"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061862"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061860"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061859"><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061862"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; StrictTriple (Set a) Bool (Set a)
</span><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">splitMemberSet</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061864"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061862"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679061857"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061857"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679061856"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061856"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061864"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061856"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-231"></span><span>              </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679061855"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061855"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679061854"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061854"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061854"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-233"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-234"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061853"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061853"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061852"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061852"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061854"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061853"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061852"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061860"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679061850"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Sett key b -&gt; Bool
</span><a href="#local-6989586621679061850"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679061849"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061849"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061846"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061846"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061849"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061846"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679061844"><span class="annot"><span class="annottext">isnull :: forall k v. Sett k v -&gt; Bool
</span><a href="#local-6989586621679061844"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061842"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061842"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061842"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679061840"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Sett key rng -&gt; Maybe rng
</span><a href="#local-6989586621679061840"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679061839"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061839"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061836"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061836"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061839"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679061836"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- ============== Basic Map =========================</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061834"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- Data.Map uses(\ new old -&gt; ...) while our convention is (\ old new -&gt; ...)</span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679061827"><span class="annot"><span class="annottext">addkv :: forall k v. Ord k =&gt; (k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
</span><a href="#local-6989586621679061827"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061826"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061826"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061825"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061825"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061824"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061824"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679061823"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679061823"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679061823"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061826"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061825"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061824"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679061818"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621679061818"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679061817"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061817"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679061816"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061816"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061817"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061816"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679061813"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Map k v -&gt; Set k
</span><a href="#local-6989586621679061813"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span id="local-6989586621679061812"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061812"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061812"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679061808"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Map k v -&gt; Set v
</span><a href="#local-6989586621679061808"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679061807"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061807"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061805"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061805"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679061804"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061804"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679061803"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679061803"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679061804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679061803"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061807"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- emptyc = Map.empty</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061792"><span id="local-6989586621679061797"><span id="local-6989586621679061799"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679061791"><span class="annot"><span class="annottext">nxt :: forall a b. Map a b -&gt; Collect (a, b, Map a b)
</span><a href="#local-6989586621679061791"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679061790"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679061790"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061789"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061789"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061788"><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061788"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679061790"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061789"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679061786"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061786"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061785"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061785"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061784"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679061784"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061788"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061786"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061785"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679061784"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061789"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679061782"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Map k b -&gt; Collect (k, b, Map k b)
</span><a href="#local-6989586621679061782"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679061781"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061781"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679061780"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061780"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679061778"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061778"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679061777"><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061781"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679061775"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061775"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679061774"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061774"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061773"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061773"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061781"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061774"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061773"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-264"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679061772"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061772"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061771"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061771"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061771"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679061769"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061769"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061768"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061768"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679061777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061767"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061766"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061765"><span class="hs-identifier hs-var">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679061778"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679061767"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679061767"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061766"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061766"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061765"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061765"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679061768"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679061761"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><a href="#local-6989586621679061761"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679061760"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061760"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061759"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679061759"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679061760"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679061759"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679061757"><span class="annot"><span class="annottext">isnull :: forall k v. Map k v -&gt; Bool
</span><a href="#local-6989586621679061757"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679061754"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><a href="#local-6989586621679061754"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Every iterable type type forms an isomorphism with some Base type. For most</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- Base types the isomorphism is the identity in both directions, but for some,</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- like List and Sett, the embeddings are not the trivial identities because the</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- concrete types are not binary type constructors. The Embed class also allows</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- us to add 'newtypes' which encode some Base type to the system.</span><span>
</span><span id="line-280"></span><span class="hs-keyword">class</span><span> </span><span id="Embed"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679062431"><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679062430"><span class="annot"><a href="#local-6989586621679062430"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062430"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="toBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-type">toBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062430"><span class="hs-identifier hs-type">base</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span id="fromBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-type">fromBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679062430"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">concrete</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062427"><span id="local-6989586621679062428"><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062428"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062428"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679062427"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062428"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062427"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679061744"><span class="annot"><span class="annottext">toBase :: [(k, v)] -&gt; List k v
</span><a href="#local-6989586621679061744"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679061743"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679061743"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679061742"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679061742"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061741"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679061742"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679061743"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679061740"><span class="annot"><span class="annottext">fromBase :: List k v -&gt; [(k, v)]
</span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679061738"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679061738"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679061738"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062425"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679062425"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062425"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679061734"><span class="annot"><span class="annottext">toBase :: Set k -&gt; Sett k ()
</span><a href="#local-6989586621679061734"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679061733"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061733"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061733"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679061732"><span class="annot"><span class="annottext">fromBase :: Sett k () -&gt; Set k
</span><a href="#local-6989586621679061732"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679061730"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061730"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679061730"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062421"><span id="local-6989586621679062422"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679062422"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062421"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679062422"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062421"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679061726"><span class="annot"><span class="annottext">toBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679061726"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679061725"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061725"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061725"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679061724"><span class="annot"><span class="annottext">fromBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679061724"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679061723"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061723"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679061723"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062417"><span id="local-6989586621679062418"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062418"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062417"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062418"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062417"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679061719"><span class="annot"><span class="annottext">toBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679061719"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679061718"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679061718"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679061718"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679061717"><span class="annot"><span class="annottext">fromBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679061717"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679061716"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679061716"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679061716"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- Necessary when asking Boolean queries like: (&#8838;),(&#8712;),(&#8713;)</span><span>
</span><span id="line-301"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679061712"><span class="annot"><span class="annottext">toBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679061712"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679061711"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061711"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061711"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span id="local-6989586621679061710"><span class="annot"><span class="annottext">fromBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679061710"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679061709"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061709"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679061709"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-304"></span></pre></body></html>